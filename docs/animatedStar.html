<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Animated Star</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="paper2-docs.css" />
    <script src="./paper2-nav.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>
  </head>
  <body>
    <paper2-nav></paper2-nav>
    <button
      style="float: right; margin: 0.5em"
      type="button"
      onclick="openInStackblitz()"
    >
      Try in Stackblitz
    </button>
    <header style="text-align: center"><h1>Animated Star</h1></header>
    <main>
      <form
        id="sbMainForm"
        method="post"
        action="https://stackblitz.com/run?file=index.html"
        target="_blank"
      >
        <input
          type="hidden"
          name="project[files][index.js]"
          value="// this file empty on purpose, put your code in the script in index.html"
        />
        <input
          type="hidden"
          id="sbInputHtml"
          name="project[files][index.html]"
          value=""
        />
        <input
          type="hidden"
          name="project[description]"
          value="Paper2 Example"
        />
        <input type="hidden" name="project[template]" value="javascript" />
        <input
          type="hidden"
          name="project[settings]"
          value='{"compile":{"clearConsole":false}}'
        />
      </form>
      <canvas id="myCanvas" resize></canvas>
    </main>
    <script>
      function openInStackblitz() {
        let html = `
        <link rel="stylesheet" href="https://emn-dev.github.io/paper2/paper2-docs.css" />
            <canvas id='myCanvas' resize></canvas>
            <script canvas="myCanvas" type="text/paperscript">`;
        const mainPaper2Script1 = document.getElementById("mainPaper2Script1");
        html +=
          mainPaper2Script1.innerHTML +
          `<\/script>
        <script>`;
        const mainPaper2Script2 = document.getElementById("mainPaper2Script2");
        html += mainPaper2Script2.innerHTML + `<\/script>`;
        const sbInputHtml = document.getElementById("sbInputHtml");
        sbInputHtml.value = html + `<\/script>`;
        document.getElementById("sbMainForm").submit();
      }
    </script>
    <script src="./paper2-ga.js"></script>
    <script id="mainPaper2Script1" canvas="myCanvas" type="text/paperscript">
      var layer = project.activeLayer;

      var values = {
        count: 34,
        points: 32,
      };

      for (var i = 0; i < values.count; i++) {
        var path = new Path({
          fillColor: i % 2 ? "red" : "black",
          closed: true,
        });

        var offset = new Point(20 + 10 * i, 0);
        var l = offset.length;
        for (var j = 0; j < values.points * 2; j++) {
          offset.angle += 360 / values.points;
          var vector = offset.normalize(l * (j % 2 ? 0.1 : -0.1));
          path.add(offset + vector);
        }
        path.smooth({ type: "continuous" });
        layer.insertChild(
          0,
          new Group({
            children: [path],
            applyMatrix: false,
          })
        );
      }

      function onFrame(event) {
        for (var i = 0; i < values.count; i++) {
          var item = layer.children[i];
          var angle = ((values.count - i) * Math.sin(event.count / 128)) / 10;
          item.rotate(angle);
        }
      }

      // Reposition the paths whenever the window is resized:
      function onResize(event) {
        layer.position = view.center;
      }
    </script>
    <script id="mainPaper2Script2">
      const resourceUri =
        location.hostname === "localhost"
          ? "./paper2-full.esm.js"
          : "https://unpkg.com/paper2/paper2-full.esm.js";

      import(resourceUri).catch((err) => console.log("err: ", err));
    </script>
  </body>
</html>
