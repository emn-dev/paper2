<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Space</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="paper2-docs.css" />
    <script src="./paper2-web-comps.js"></script>
    <script src="./paper2-stackblitz.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>
  </head>
  <body>
    <paper2-nav></paper2-nav>
    <paper2-stackblitz></paper2-stackblitz>
    <header style="text-align: center"><h1>Space</h1></header>
    <main>
      <canvas id="myCanvas" resize></canvas>
    </main>
    <script src="./paper2-ga.js"></script>
    <script id="mainPaper2Script1" canvas="myCanvas" type="text/paperscript">
      // The amount of symbol we want to place;
      var count = 150;

      // Create a symbol, which we will use to place instances of later:
      var path = new Path.Circle({
        center: new Point(0, 0),
        radius: 5,
        fillColor: "white",
        strokeColor: "black",
      });

      var symbol = new SymbolDefinition(path);

      // Place the instances of the symbol:
      for (var i = 0; i < count; i++) {
        // The center position is a random point in the view:
        var center = Point.random() * view.size;
        var placed = symbol.place(center);
        var scale = (i + 1) / count;
        placed.scale(scale);
        placed.data.vector = new Point({
          angle: Math.random() * 360,
          length: (scale * Math.random()) / 5,
        });
      }

      var vector = new Point({
        angle: 45,
        length: 0,
      });

      var mouseVector = vector.clone();

      function onMouseMove(event) {
        mouseVector = view.center - event.point;
      }

      // The onFrame function is called up to 60 times a second:
      function onFrame(event) {
        vector = vector + (mouseVector - vector) / 30;

        // Run through the active layer's children list and change
        // the position of the placed symbols:
        for (var i = 0; i < count; i++) {
          var item = project.activeLayer.children[i];
          var size = item.bounds.size;
          var length = ((vector.length / 10) * size.width) / 10;
          item.position += vector.normalize(length) + item.data.vector;
          keepInView(item);
        }
      }

      function keepInView(item) {
        var position = item.position;
        var itemBounds = item.bounds;
        var bounds = view.bounds;
        if (itemBounds.left > bounds.width) {
          position.x = -item.bounds.width;
        }

        if (position.x < -itemBounds.width) {
          position.x = bounds.width + itemBounds.width;
        }

        if (itemBounds.top > view.size.height) {
          position.y = -itemBounds.height;
        }

        if (position.y < -itemBounds.height) {
          position.y = bounds.height + itemBounds.height / 2;
        }
      }
    </script>
    <script id="mainPaper2Script2">
      const resourceUri =
        location.hostname === "localhost"
          ? "./paper2-full.esm.js"
          : "https://unpkg.com/paper2/paper2-full.esm.js";

      import(resourceUri).catch((err) => console.log("err: ", err));
    </script>
  </body>
</html>
