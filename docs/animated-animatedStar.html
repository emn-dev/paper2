<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Animated Star</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="paper2-docs.css" />
    <script src="./paper2-web-comps.js"></script>
    <script src="./paper2-stackblitz.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>
  </head>
  <body>
    <paper2-nav></paper2-nav>
    <header style="text-align: center">
      <h1>Animated Star</h1>
      <paper2-stackblitz></paper2-stackblitz>
      <p>&nbsp;</p>
    </header>
    <main>
      <canvas id="myCanvas" resize></canvas>
    </main>
    <script src="./paper2-ga.js"></script>
    <script id="mainPaper2Script1" canvas="myCanvas" type="text/paperscript">

      var layer = project.activeLayer;
      var stopAt = window.Cypress ? 60 : Infinity; // Doing this so we can have Cypress test
      var counter = 0;

      var values = {
        count: 34,
        points: 32,
      };

      for (var i = 0; i < values.count; i++) {
        var path = new Path({
          fillColor: i % 2 ? "red" : "black",
          closed: true,
        });

        var offset = new Point(20 + 10 * i, 0);
        var l = offset.length;
        for (var j = 0; j < values.points * 2; j++) {
          offset.angle += 360 / values.points;
          var vector = offset.normalize(l * (j % 2 ? 0.1 : -0.1));
          path.add(offset + vector);
        }
        path.smooth({ type: "continuous" });
        layer.insertChild(
          0,
          new Group({
            children: [path],
            applyMatrix: false,
          })
        );
      }

      function onFrame(event) {
        counter += 1;

        if (counter < stopAt) {
          for (var i = 0; i < values.count; i++) {
            var item = layer.children[i];
            var angle = ((values.count - i) * Math.sin(event.count / 128)) / 10;
            item.rotate(angle);
          }
        }
      }

      // Reposition the paths whenever the window is resized:
      function onResize(event) {
        layer.position = view.center;
      }
    </script>
    <script id="mainPaper2Script2">
      const resourceUri =
        location.hostname === "localhost"
          ? "./paper2.js"
          : "https://unpkg.com/paper2/paper2.js";

      import(resourceUri).catch((err) => console.log("err: ", err));
    </script>
  </body>
</html>
